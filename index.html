<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>
    <script src="mole_acre.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mole Acre</title>
  </head>
  <body>
    <a-scene>
        <a-assets>
            <!--Models-->
            <a-asset-item id="mole-model" src="https://acodedoer.github.io/aframe-whack-a-mole/models/mole-model.glb"></a-asset-item>
            <a-asset-item id="hammer-model" src="https://acodedoer.github.io/aframe-whack-a-mole/models/hammer.glb"></a-asset-item>

            <!--Sound-->
            <audio id="hit-sound" src="https://acodedoer.github.io/aframe-whack-a-mole/sounds/impact.ogg" preload="auto"></audio>

            <!--Mixins-->
            <a-mixin id="mole" scale="0.3 0.3 0.3" gltf-model="#mole-model"></a-mixin>
            <a-mixin id="hammer" rotation="0 0 0" gltf-model="#hammer-model"></a-mixin>

            <a-mixin id="final-score-animation" animation="property: scale; to: 2 2 2; dur: 500;"></a-mixin>

            <a-mixin id="control-allowRestart-animation" animation__restart="property: position; to: 0 0 0; dur: 500;"></a-mixin>
            <a-mixin id="hole-end-animation" animation="property: geometry.radius; to: 0.05; dur: 500; easing:	easeOutQuart;"></a-mixin>
            <a-mixin id="hole-start-animation" animation="property: geometry.radius; to: 0.3; dur: 500; easing:	easeOutQuart;"></a-mixin>

            <a-mixin id="mole-animation" animation="property: position; to: 0 0 0; dur: 1000; easing:	easeOutQuart; loop:1; dir: alternate"></a-mixin>

            <a-mixin id="leg" geometry="primitive:box; width:0.1; depth:0.1" material="color:black"></a-mixin>
        </a-assets>


        <a-entity camera position="0 1.6 0" wasd-controls look-controls="pointerLockEnabled:true"> 
          <a-entity hammer-logic id="cursor-entity" cursor="fuse: true; fuseTimeout: 500"
            position="0 0 -1"
            animation__click="property: rotation; startEvents: click; easing: easeInCubic; dur: 250; from: -45 0 0; to: 0 0 0"
            animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 500; from: 0.1 0.1 0.1; to:0.15 0.15 0.15"
            animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 250; to: 0.1 0.1 0.1"
            geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
            material="color: black; shader: flat"
            scale="0.1 0.1 0.1"
            mixin="hammer"
            raycaster="objects: .clickable"
            sound="src: #hit-sound; on: click"
            >
          </a-entity>
        </a-entity>

        <a-entity>
          <a-entity mixin="leg" position="-1 0 -4"></a-entity>
          <a-entity mixin="leg" position="1 0 -4"></a-entity>
          <a-box depth="0.1" height="1" width="3" position="0 1 -4">
            <a-entity scale="8 8 8" position="0 0  0.15" text="value: Mole Acre; align:center;"></a-entity>
          </a-box>
        </a-entity>

        <a-entity environment="preset: forest;" id='stage' mole-acre position="0 0 -2.2">
          <a-entity control="gameDuration:30000; popMultiple: false" id="control-entity" geometry="primitive:box; height:0.5; width:1; depth:0.6" class="clickable" position="0 0 0" material="color:#9c6644">
            <a-entity id ="control-score" scale="4 4 4"  rotation="-90 0 0" position="0 0.25 -0.15" text="value:; align:center;"></a-entity>
            <a-entity id ="control-instruction" scale="3.5 3.5 3.5"  rotation="-90 0 0" position="0 0.25 0.15" text="value: Hit to Play!; align:center;"></a-entity>
          </a-entity>
        </a-entity>

    </a-scene>
  </body>
</html>